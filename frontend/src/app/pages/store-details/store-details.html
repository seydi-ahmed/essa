<main class="store-details-page">
  <div class="container">
    <button class="back-btn" (click)="goBack()">← Retour</button>

    <!-- Affichage en cours de chargement -->
    <div class="loading" *ngIf="loading">
      <p>Chargement...</p>
    </div>

    <!-- Formulaire de création / édition -->
    <div *ngIf="!loading && store && store.id === 0" class="store-form">
      <h1>Créer un nouveau magasin</h1>
      <form (ngSubmit)="saveStore()" #storeForm="ngForm">
        <div class="form-group">
          <label>Nom</label>
          <input type="text" [(ngModel)]="store.name" name="name" required />
        </div>

        <div class="form-group">
          <label>Adresse</label>
          <input type="text" [(ngModel)]="store.address" name="address" required />
        </div>

        <div class="form-group">
          <label>Ville</label>
          <input type="text" [(ngModel)]="store.city" name="city" required />
        </div>

        <div class="form-group">
          <label>Téléphone</label>
          <input type="text" [(ngModel)]="store.phone" name="phone" />
        </div>

        <div class="form-group">
          <label>Description</label>
          <textarea [(ngModel)]="store.description" name="description"></textarea>
        </div>

        <button type="submit" class="btn btn-primary">Enregistrer</button>
      </form>
    </div>

    <!-- Vue détail d’un magasin existant -->
    <div *ngIf="!loading && store && store.id !== 0" class="store-details">
      <div class="store-header">
        <h1>{{ store.name }}</h1>
        <div class="store-meta">
          <span>{{ store.city }}</span>
          <span>{{ store.phone }}</span>
        </div>
        <p class="store-address">{{ store.address }}</p>
        <p class="store-description">{{ store.description }}</p>
      </div>

      <div class="products-section">
        <h2>Produits du magasin</h2>

        <div class="products-grid" *ngIf="products.length > 0">
          <div class="product-card" *ngFor="let product of products" (click)="viewProduct(product.id)">
            <div class="product-image">
              <img [src]="product.imageUrl || '/assets/placeholder-product.jpg'" [alt]="product.name" />
            </div>
            <div class="product-info">
              <h3>{{ product.name }}</h3>
              <p class="product-category">{{ product.category }}</p>
              <p class="product-description">{{ product.description }}</p>
              <div class="product-meta">
                <span class="product-price">{{ product.price | currency:'EUR' }}</span>
                <span class="product-quantity" [class.low-stock]="product.quantity < 10">
                  {{ product.quantity }} en stock
                </span>
              </div>
              <p class="product-brand" *ngIf="product.brand">{{ product.brand }}</p>
            </div>
          </div>
        </div>

        <div class="empty-state" *ngIf="products.length === 0">
          <h3>Aucun produit trouvé</h3>
          <p>Ce magasin n'a pas encore de produits enregistrés.</p>
        </div>
      </div>
    </div>
  </div>
</main>
